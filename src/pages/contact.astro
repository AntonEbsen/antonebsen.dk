---
import Layout from '../layouts/Layout.astro';
import Section from '../components/ui/Section.astro';
import Card from '../components/ui/Card.astro';
import Button from '../components/ui/Button.astro';
---

<Layout 
  title="Kontakt | Anton Ebsen" 
  description="Kontaktformular for Anton Ebsen."
>
  <style>
    .contact-wrap {
        max-width: 800px;
        margin: 40px auto;
        padding: 0 16px;
    }
  </style>

  <main class="contact-wrap">
     <Section>
        <Card variant="glass" class="p-8 md:p-12">
            <h1 class="text-4xl font-bold mb-6 text-center">Kontakt</h1>
            <p class="text-dim text-center mb-8 text-lg">
                Har du et spørgsmål, en idé til et projekt, eller vil du bare sige hej? <br/>
                Udfyld formularen herunder, så lander beskeden direkte i mit system.
            </p>

            <form id="contact-form" class="space-y-6 max-w-lg mx-auto">
                <div>
                    <label class="block text-accent text-xs font-bold uppercase tracking-wider mb-2">Navn</label>
                    <input type="text" id="c-name" name="name" required class="w-full bg-black/50 border border-white/10 p-3 rounded text-white focus:border-accent focus:outline-none transition-colors" placeholder="Dit navn" />
                </div>
                
                <div>
                    <label class="block text-accent text-xs font-bold uppercase tracking-wider mb-2">Email</label>
                    <input type="email" id="c-email" name="email" required class="w-full bg-black/50 border border-white/10 p-3 rounded text-white focus:border-accent focus:outline-none transition-colors" placeholder="din@email.dk" />
                </div>

                <div>
                    <label class="block text-accent text-xs font-bold uppercase tracking-wider mb-2">Besked</label>
                    <textarea id="c-message" name="message" required rows="5" class="w-full bg-black/50 border border-white/10 p-3 rounded text-white focus:border-accent focus:outline-none transition-colors" placeholder="Hvad har du på hjertet?"></textarea>
                </div>

                <div id="form-status" class="hidden p-4 rounded bg-accent/20 text-accent text-center text-sm mb-4">
                    Tak for din besked! Jeg vender tilbage hurtigst muligt.
                </div>

                <Button type="submit" size="lg" icon="paper-plane" class="w-full justify-center">Send Besked</Button>
            </form>
        </Card>
     </Section>
  </main>
</Layout>

<script>
    const form = document.getElementById('contact-form') as HTMLFormElement;
    const status = document.getElementById('form-status')!;

    form?.addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        const data = Object.fromEntries(formData);
        
        try {
            const res = await fetch('/api/contact', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (res.ok) {
                form.reset();
                status.classList.remove('hidden');
                setTimeout(() => status.classList.add('hidden'), 5000);
            } else {
                alert('Der skete en fejl. Prøv igen senere.');
            }
        } catch (err) {
            console.error(err);
            alert('Kunne ikke forbinde til serveren.');
        }
    });
</script>
