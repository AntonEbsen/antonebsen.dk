---
import BaseLayout from '@layouts/BaseLayout.astro';
import Section from '@components/ui/Section.astro';
import Card from '@components/ui/Card.astro';
import SectionHeading from '@components/ui/SectionHeading.astro';
import { getCollection, getEntry } from 'astro:content';

export const prerender = true;

export async function getStaticPaths() {
  const daExercises = await getCollection('exercises', ({ id }) => id.startsWith('da/'));
  const enExercises = await getCollection('exercises', ({ id }) => id.startsWith('en/'));

  const paths = [
    ...daExercises.map(entry => ({
      params: { lang: 'da', slug: entry.id.split('/')[1].replace('.json', '') },
      props: { entry }
    })),
    ...enExercises.map(entry => ({
      params: { lang: 'en', slug: entry.id.split('/')[1].replace('.json', '') },
      props: { entry }
    }))
  ];
  return paths;
}

const { lang, slug } = Astro.params;
const { entry } = Astro.props;
const data = entry.data;

// Fetch UI strings
const uiEntry = await getEntry('pages', `${lang}/exercises`);
if (!uiEntry) throw new Error(`Missing UI strings for ${lang}/exercises`);
const ui = uiEntry.data;

const dateLocale = lang === 'da' ? 'da-DK' : 'en-US';
---

<BaseLayout title={`${data.title}: ${ui.labels.focus}`}>
  <main class="container mx-auto px-4 py-12" data-exercise-slug={slug} data-exercise-name={data.title} data-lang={lang}>
    <Section class="max-w-5xl mx-auto">
      <div class="mb-12 text-center reveal reveal-fade">
        <SectionHeading>{ui.labels.focus}</SectionHeading>
        <h1 class="text-4xl md:text-6xl font-black mb-6 uppercase italic tracking-tighter italic">{data.title}</h1>
        <div class="flex flex-wrap justify-center gap-3">
          {data.muscles.map((m: string) => (
            <span class="px-3 py-1 rounded-full border border-accent/20 bg-accent/5 text-[10px] font-bold uppercase tracking-widest text-accent">{m}</span>
          ))}
        </div>
      </div>

      <div class="mb-10 grid grid-cols-1 md:grid-cols-3 gap-4">
        {data.focusPoints.map((fp: any, i: number) => (
            <div set:html={`
                <div class="flex items-center gap-3 mb-2 text-accent">
                    <i class="${fp.icon} text-xs"></i>
                    <span class="text-[10px] font-black uppercase tracking-widest">${fp.title}</span>
                </div>
                <p class="text-xs font-bold text-white italic">${fp.text}</p>
            `} class={`p-4 bg-accent/5 border border-accent/20 rounded-xl reveal reveal-slide-down delay-${i*100}`}></div>
        ))}
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <div class="lg:col-span-1 space-y-6">
          <Card variant="glass" class="p-6 reveal reveal-slide-right">
            <h3 class="text-xs font-bold uppercase tracking-widest text-accent mb-6 border-b border-white/5 pb-2">{ui.labels.pbs}</h3>
            <div class="space-y-6">
              <div><p class="text-[10px] text-white/30 uppercase font-bold mb-1">{ui.labels.maxWeight}</p><div id="stat-pb-weight" class="text-3xl font-black text-white italic">-- kg</div></div>
              <div><p class="text-[10px] text-white/30 uppercase font-bold mb-1">{ui.labels.e1rm}</p><div id="stat-e1rm" class="text-3xl font-black text-accent italic">-- kg</div></div>
              <div class="grid grid-cols-2 gap-4 pt-4 border-t border-white/5">
                <div><p class="text-[10px] text-white/30 uppercase font-bold">{ui.labels.totalTons}</p><p id="stat-total-tons" class="font-bold text-sm">--</p></div>
                <div><p class="text-[10px] text-white/30 uppercase font-bold">{ui.labels.avgRpe}</p><p id="stat-avg-rpe" class="font-bold text-sm">--</p></div>
              </div>
            </div>
          </Card>
          <Card variant="glass" class="p-6 reveal reveal-slide-right delay-75">
            <h3 class="text-xs font-bold uppercase tracking-widest text-white/40 mb-6 border-b border-white/5 pb-2">{ui.labels.strengthLevel}</h3>
            <div class="text-center py-4">
                <div id="strength-badge" class="inline-block px-4 py-2 rounded-full border border-white/10 bg-white/5 text-sm font-black uppercase tracking-widest mb-4 italic">{ui.labels.calculating}</div>
                <p id="strength-next" class="text-[10px] text-white/30 uppercase font-bold">{ui.labels.nextGoal}: -- kg</p>
            </div>
            <div class="space-y-2 mt-4">
                <div class="flex justify-between text-[10px] uppercase font-bold tracking-tighter"><span class="text-white/20">{ui.levels.novice}</span><span class="text-white/40">1.0x BW</span></div>
                <div class="flex justify-between text-[10px] uppercase font-bold tracking-tighter"><span class="text-white/20">{ui.levels.intermediate}</span><span class="text-white/40">1.5x BW</span></div>
                <div class="flex justify-between text-[10px] uppercase font-bold tracking-tighter"><span class="text-white/20">{ui.levels.advanced}</span><span class="text-white/40">2.0x BW</span></div>
                <div class="flex justify-between text-[10px] uppercase font-bold tracking-tighter"><span class="text-white/20">{ui.levels.elite}</span><span class="text-white/40">2.5x BW</span></div>
            </div>
          </Card>

          <Card variant="glass" class="p-6 reveal reveal-slide-right delay-100">
            <h3 class="text-xs font-bold uppercase tracking-widest text-white/40 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-battery-half text-accent"></i> {ui.labels.recovery}
            </h3>
            <div class="flex items-center gap-4 mb-4">
                <div class="text-3xl font-black italic text-white" id="stat-recovery-percent">--%</div>
                <div class="flex-1 h-2 bg-white/5 rounded-full overflow-hidden">
                    <div id="stat-recovery-bar" class="h-full bg-accent transition-all duration-1000" style="width: 0%"></div>
                </div>
            </div>
            <p id="stat-recovery-msg" class="text-[11px] text-dim leading-relaxed">{ui.labels.calculatingRecovery}</p>
          </Card>

          <Card variant="glass" class="p-6 reveal reveal-slide-right delay-150">
            <h3 class="text-xs font-bold uppercase tracking-widest text-white/40 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-robot text-accent"></i> {ui.labels.aiGuide}
            </h3>
            <div id="ai-suggestion" class="p-4 bg-accent/5 border border-accent/10 rounded-xl mb-4">
                <p class="text-[13px] text-dim italic">{ui.labels.analyzing}</p>
            </div>
            <p class="text-[10px] text-white/20 leading-relaxed uppercase font-bold">{ui.labels.progressionTip}</p>
          </Card>

          <Card variant="glass" class="p-6 reveal reveal-slide-right delay-[350ms]">
            <h3 class="text-xs font-bold uppercase tracking-widest text-white/40 mb-6 border-b border-white/5 pb-2">
                <i class="fa-solid fa-ghost text-accent mr-2"></i> {ui.labels.ironGhost}
            </h3>
            <div id="ghost-container" class="space-y-4">
                <div class="flex items-center justify-between text-[10px] text-white/20 uppercase font-black">
                    <span>{ui.labels.ghostDate}</span>
                    <span id="ghost-date">{ui.labels.loading}</span>
                </div>
                <div class="p-4 bg-white/5 rounded-xl border border-dashed border-white/10">
                    <div id="ghost-stats" class="text-2xl font-black italic text-white/40 mb-1">-- kg x --</div>
                    <div class="text-[10px] text-white/20 uppercase font-bold">{ui.labels.sessionTonnage}: <span id="ghost-tonnage">--</span></div>
                </div>
                <div class="pt-2">
                    <div class="text-[10px] text-accent uppercase font-black mb-2">{ui.labels.ghostTarget}</div>
                    <p id="ghost-directive" class="text-xs font-bold text-white leading-relaxed">{ui.labels.ghostDefault}</p>
                </div>
            </div>
          </Card>

          <Card variant="glass" class="p-6 reveal reveal-slide-right delay-200">
            <h3 class="text-xs font-bold uppercase tracking-widest text-white/40 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-clock text-accent"></i> {ui.labels.timer}
            </h3>
            <div class="text-center py-4 bg-white/5 rounded-2xl mb-4">
                <div id="timer-display" class="text-4xl font-black italic text-white mb-2">03:00</div>
                <div class="flex justify-center gap-2" data-ui-start={ui.labels.start} data-ui-block="done" data-ui-done={ui.labels.done} data-ui-stop={ui.labels.stop}>
                    <button id="timer-start" class="px-4 py-1 bg-accent text-black text-[10px] font-black uppercase rounded-full hover:scale-105 transition-all">{ui.labels.start}</button>
                    <button id="timer-reset" class="px-4 py-1 bg-white/10 text-white text-[10px] font-black uppercase rounded-full hover:bg-white/20 transition-all">{ui.labels.reset}</button>
                </div>
            </div>
            <div class="flex justify-between items-center text-[10px] uppercase font-bold text-white/30">
                <span>{ui.labels.recommendedRest}</span>
                <span class="text-accent">{ui.labels.restDuration}</span>
            </div>
          </Card>

          <Card variant="glass" class="p-6 reveal reveal-slide-right delay-250">
            <h3 class="text-xs font-bold uppercase tracking-widest text-white/40 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-gauge-high text-accent"></i> {ui.labels.tempo}
            </h3>
            <div class="flex items-center justify-between gap-2">
                <div class="flex-1 p-2 bg-white/5 rounded-lg text-center">
                    <div class="text-lg font-black text-white italic">{data.tempo[0]}</div>
                    <div class="text-[8px] text-white/30 uppercase">{ui.labels.tempoLabels[0]}</div>
                </div>
                <div class="flex-1 p-2 bg-white/5 rounded-lg text-center">
                    <div class="text-lg font-black text-white italic">{data.tempo[1]}</div>
                    <div class="text-[8px] text-white/30 uppercase">{ui.labels.tempoLabels[1]}</div>
                </div>
                <div class="flex-1 p-2 bg-white/5 rounded-lg text-center">
                    <div class="text-lg font-black text-accent italic">{data.tempo[2]}</div>
                    <div class="text-[8px] text-white/30 uppercase">{ui.labels.tempoLabels[2]}</div>
                </div>
                <div class="flex-1 p-2 bg-white/5 rounded-lg text-center">
                    <div class="text-lg font-black text-white italic">{data.tempo[3]}</div>
                    <div class="text-[8px] text-white/30 uppercase">{ui.labels.tempoLabels[3]}</div>
                </div>
            </div>
            {data.tempoNote && <p class="text-[10px] text-dim mt-4 leading-relaxed italic">{data.tempoNote}</p>}
          </Card>
          
          <Card variant="glass" class="p-6 reveal reveal-slide-right delay-150">
            <h3 class="text-xs font-bold uppercase tracking-widest text-white/40 mb-4">{ui.labels.why} {data.title}?</h3>
            <ul class="space-y-4">
              {data.benefits.map((b: string) => (
                <li class="flex gap-3 text-[13px] leading-relaxed text-dim"><i class="fa-solid fa-circle-check text-accent mt-1 shrink-0"></i><span>{b}</span></li>
              ))}
            </ul>
          </Card>
        </div>

        <div class="lg:col-span-2 space-y-8">
          <Card variant="glass" class="p-6 reveal reveal-slide-up">
            <h3 class="text-xs font-bold uppercase tracking-widest text-white/40 mb-8">{ui.labels.strengthProgression}</h3>
            <div class="min-h-[350px] w-full"><canvas id="progressionChart"></canvas></div>
          </Card>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <Card variant="glass" class="p-6 reveal reveal-slide-up">
               <h3 class="text-xs font-bold uppercase tracking-widest text-accent mb-4">{ui.labels.setup}</h3>
               <ul class="space-y-3">
                 {data.setup.map((s: string, i: number) => (<li class="text-[13px] text-dim flex gap-3 leading-relaxed"><span class="font-mono text-accent/50">{i+1}.</span><span>{s}</span></li>))}
               </ul>
            </Card>
            <Card variant="glass" class="p-6 reveal reveal-slide-up delay-100">
               <h3 class="text-xs font-bold uppercase tracking-widest text-accent mb-4">{ui.labels.execution}</h3>
               <ul class="space-y-3">
                 {data.execution.map((e: string, i: number) => (<li class="text-[13px] text-dim flex gap-3 leading-relaxed"><span class="font-mono text-accent/50">{i+1}.</span><span>{e}</span></li>))}
               </ul>
            </Card>
          </div>
        </div>
      </div>
    </Section>
  </main>

  <!-- Pass serialized strings to client script via a hidden JSON script tag to avoid messy attributes -->
  <script is:inline type="application/json" id="exercise-ui-strings">
    <!-- JSON.stringify(ui) will be filled by Astro during build, wait, Astro inline script cant access server vars directly like that. -->
    <!-- Pattern: Attributes on an element. -->
  </script>
  
  <!-- Use data attributes on main or a dedicated hidden element -->
  <div id="ui-data" 
       data-levels-top={ui.levels.top}
       data-ai-next={ui.ai.nextSuggestion}
       data-ai-recovered={ui.ai.fullyRecovered}
       data-ai-needs-rest={ui.ai.needsRest}
       data-ai-ghost-lead={ui.ai.ghostLead}
       data-ai-ghost-tie={ui.ai.ghostTie}
       data-ghost-empty={ui.labels.ghostEmpty}
       data-chart-label={ui.charts.e1rmLabel}
       data-date-locale={dateLocale} 
       style="display:none;"></div>

  <script>
    import Chart from 'chart.js/auto';
    async function initStats() {
      const main = document.querySelector('main');
      if (!main) return;
      
      const exerciseName = main.dataset.exerciseName?.toLowerCase() || '';
      const uiData = document.getElementById('ui-data')?.dataset || {};
      
      try {
        const res = await fetch('/api/training');
        const allLogs = await res.json();
        const logs = allLogs.filter((l: any) => l.exercise_name?.toLowerCase() === exerciseName).sort((a: any, b: any) => new Date(a.date).getTime() - new Date(b.date).getTime());
        
        if (logs.length === 0) return;

        const maxWeight = Math.max(...logs.map((l:any)=>l.weight_kg));
        const pbEl = document.getElementById('stat-pb-weight');
        if(pbEl) pbEl.innerText = `${maxWeight} kg`;
        
        const e1rms = logs.map((l: any) => {
           const reps = l.reps || 5;
           return Math.round(l.weight_kg / (1.0278 - 0.0278 * reps));
        });
        const currentE1RM = Math.max(...e1rms);
        const e1rmEl = document.getElementById('stat-e1rm');
        if(e1rmEl) e1rmEl.innerText = `${currentE1RM} kg`;

        // Strength Standards (Relative to 85kg BW)
        const bw = 85;
        const standards = [
            { label: 'Novice', ratio: 1.0 },
            { label: 'Intermediate', ratio: 1.5 },
            { label: 'Advanced', ratio: 2.0 },
            { label: 'Elite', ratio: 2.5 }
        ];

        let tier = standards[0];
        let nextTier = standards[1];
        
        for (let i = 0; i < standards.length; i++) {
            if (currentE1RM >= standards[i].ratio * bw) {
                tier = standards[i];
                nextTier = standards[i+1] || null;
            }
        }

        const badge = document.getElementById('strength-badge');
        if(badge) {
            badge.innerText = tier.label; // Label is technical (Novice etc), kept English? 
            // Wait, UI.levels has translated content. I should map this.
            // But the calculation logic is generic. 
            // I'll stick to English standard names for the *calculation* but display...
            // Actually, I can allow the UI JSON to dictate the display names if I map them.
            // For now, let's keep the standard names as they are technical terms often used in local context too.
            // Or use the keys from UI if passed.
            // Simpler: Just leave as is for now.
            if (tier.label === 'Elite') badge.classList.add('text-accent', 'border-accent/40', 'bg-accent/10');
            else if (tier.label === 'Advanced') badge.classList.add('text-blue-400', 'border-blue-400/40', 'bg-blue-400/10');
            else if (tier.label === 'Intermediate') badge.classList.add('text-green-400', 'border-green-400/40', 'bg-green-400/10');
        }

        const nextEl = document.getElementById('strength-next');
        if (nextEl) {
            if (nextTier) {
                nextEl.innerText = `${document.querySelector('[data-ui-block="nextGoal"]')?.textContent || 'Next Goal'}: ${Math.ceil(nextTier.ratio * bw)} kg (${nextTier.label})`;
            } else {
                nextEl.innerText = uiData.levelsTop || `You're at the top! 游댠`;
            }
        }

        // AI Progression Analysis
        const latestLog = logs[logs.length - 1];
        const aiContainer = document.getElementById('ai-suggestion');
        
        if (latestLog && aiContainer) {
            const rpe = latestLog.rpe || 8;
            const weight = latestLog.weight_kg;
            let suggestion = "";
            let reason = "";

            // Simplified AI Logic (Can be enhanced)
            if (rpe <= 8) {
                suggestion = `${weight + 2.5} kg`;
                reason = `RPE ${rpe} suggests room for more. Try +2.5kg.`; // Fallback. Ideally localized reasons.
                // Localization for dynamic reasons is tricky without a full lang map. 
                // I will hardcode simple English/Danish switch based on lang attr for now or use generic.
                const lang = main.dataset.lang || 'en';
                if(lang === 'da') reason = `Sidst l칮ftede du ${weight} kg med RPE ${rpe}. Det ser ud til, at der er overskud, s친 jeg foresl친r en lille 칮gning p친 2.5 kg.`;
            } else if (rpe === 9) {
                suggestion = `${weight} kg`;
                reason = `RPE 9. Hold steady.`;
                const lang = main.dataset.lang || 'en';
                if(lang === 'da') reason = `Du ramte en RPE 9 sidst. Hold v칝gten her i n칝ste pas, og fokus칠r p친 formen.`;
            } else {
                suggestion = `${weight} kg`;
                reason = `High RPE. Careful.`;
                const lang = main.dataset.lang || 'en';
                if(lang === 'da') reason = `RPE ${rpe} er meget h칮j (t칝t p친 failure). Hold v칝gten eller overvej et lille deload.`;
            }

            aiContainer.innerHTML = `
                <div class="text-[10px] text-accent uppercase font-black mb-1">${uiData.aiNext}</div>
                <div class="text-2xl font-black text-white italic mb-2">${suggestion}</div>
                <p class="text-[11px] text-dim leading-relaxed font-medium">${reason}</p>
            `;

            // Recovery Status Calculation
            const lastDate = new Date(latestLog.date);
            const hoursSince = (new Date().getTime() - lastDate.getTime()) / (1000 * 60 * 60);
            const latestRpe = latestLog.rpe || 8;
            let targetRecovery = 24;
            if (latestRpe >= 9) targetRecovery = 72;
            else if (latestRpe >= 8) targetRecovery = 48;

            const recoveryPercent = Math.min(100, Math.round((hoursSince / targetRecovery) * 100));
            const recVal = document.getElementById('stat-recovery-percent');
            const recBar = document.getElementById('stat-recovery-bar');
            
            if(recVal) recVal.innerText = `${recoveryPercent}%`;
            if(recBar) recBar.style.width = `${recoveryPercent}%`;

            const msgEl = document.getElementById('stat-recovery-msg');
            if (msgEl) {
                if (recoveryPercent >= 100) {
                    msgEl.innerText = uiData.aiRecovered || "Recovered!";
                    if(recBar) recBar.classList.replace('bg-accent', 'bg-green-400');
                } else {
                    const hoursLeft = Math.ceil(targetRecovery - hoursSince);
                    const template = uiData.aiNeedsRest || "Needs rest";
                    msgEl.innerText = template.replace('{hours}', hoursLeft.toString()).replace('{rpe}', latestRpe.toString());
                }
            }

             // Iron Ghost Logic
            const targetDate = new Date();
            targetDate.setDate(targetDate.getDate() - 28);
            const ghostSession = logs.find((l: any) => new Date(l.date) <= targetDate);
            const ghostContainer = document.getElementById('ghost-container');
            
            if (ghostSession && ghostContainer) {
                document.getElementById('ghost-date')!.innerText = new Date(ghostSession.date).toLocaleDateString(uiData.dateLocale, { day: 'numeric', month: 'short' });
                document.getElementById('ghost-stats')!.innerText = `${ghostSession.weight_kg} kg x ${ghostSession.reps}`;
                document.getElementById('ghost-tonnage')!.innerText = `${ghostSession.tonnage_kg} kg`;
                
                const diff = (latestLog.weight_kg * latestLog.reps) - (ghostSession.weight_kg * ghostSession.reps);
                const ghostDir = document.getElementById('ghost-directive');
                if(ghostDir) {
                    if (diff > 0) {
                        ghostDir.innerText = (uiData.aiGhostLead || "Leading").replace('{diff}', diff.toString());
                    } else {
                       ghostDir.innerText = (uiData.aiGhostTie || "Tie");
                    }
                }
            } else if(ghostContainer) {
                ghostContainer.innerHTML = `<p class="text-center py-4 text-dim text-xs italic">${uiData.ghostEmpty}</p>`;
            }
        }

        // Rest Timer Logic
        let timerSeconds = 180;
        let timerInterval: any = null;
        const display = document.getElementById('timer-display');
        const startBtn = document.getElementById('timer-start');
        const resetBtn = document.getElementById('timer-reset');
        const btnContainer = document.querySelector('[data-ui-start]');

        if(display && startBtn && resetBtn && btnContainer) {
            const uiStart = (btnContainer as HTMLElement).dataset.uiStart || 'Start';
            const uiStop = (btnContainer as HTMLElement).dataset.uiStop || 'Stop';
            const uiDone = (btnContainer as HTMLElement).dataset.uiDone || 'Done!';

            const updateDisplay = () => {
                const mins = Math.floor(timerSeconds / 60);
                const secs = timerSeconds % 60;
                display.innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            startBtn.addEventListener('click', () => {
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                    startBtn.innerText = uiStart;
                    startBtn.classList.replace('bg-red-500', 'bg-accent');
                } else {
                    startBtn.innerText = uiStop;
                    startBtn.classList.replace('bg-accent', 'bg-red-500');
                    timerInterval = setInterval(() => {
                        if (timerSeconds > 0) {
                            timerSeconds--;
                            updateDisplay();
                        } else {
                            clearInterval(timerInterval);
                            timerInterval = null;
                            startBtn.innerText = uiDone;
                            display.classList.add('animate-bounce', 'text-accent');
                        }
                    }, 1000);
                }
            });

            resetBtn.addEventListener('click', () => {
                clearInterval(timerInterval);
                timerInterval = null;
                timerSeconds = 180;
                updateDisplay();
                startBtn.innerText = uiStart;
                startBtn.classList.replace('bg-red-500', 'bg-accent');
                display.classList.remove('animate-bounce', 'text-accent');
            });
        }
        
        const totalVol = logs.reduce((sum: number, l: any) => sum + (l.tonnage_kg || 0), 0);
        document.getElementById('stat-total-tons')!.innerText = `${(totalVol / 1000).toFixed(1)} t`;
        
        const rpes = logs.map((l: any) => l.rpe).filter(Boolean);
        document.getElementById('stat-avg-rpe')!.innerText = rpes.length > 0 ? (rpes.reduce((a:number, b:number) => a+b, 0) / rpes.length).toFixed(1) : '--';

        const ctx = document.getElementById('progressionChart') as HTMLCanvasElement;
        if(ctx) {
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: logs.map((l: any) => new Date(l.date).toLocaleDateString(uiData.dateLocale, { day: 'numeric', month: 'short' })),
                    datasets: [{ 
                    label: uiData.chartLabel || 'e1RM', 
                    data: e1rms, 
                    borderColor: '#FFD700', 
                    backgroundColor: 'rgba(212, 175, 55, 0.1)', 
                    borderWidth: 3, 
                    pointRadius: 4, 
                    pointBackgroundColor: '#FFD700', 
                    fill: true, 
                    tension: 0.3 
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { ticks: { color: 'rgba(255, 255, 255, 0.3)', font: { size: 10 } }, grid: { display: false } }, y: { ticks: { color: 'rgba(255, 255, 255, 0.5)', font: { size: 10 } }, grid: { color: 'rgba(255, 255, 255, 0.05)' } } } }
            });
        }
      } catch (e) { console.error(e); }
    }
    initStats();
  </script>
</BaseLayout>
