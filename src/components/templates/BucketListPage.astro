---
import Layout from '@layouts/BaseLayout.astro';
import Section from '@components/ui/Section.astro';
import Card from '@components/ui/Card.astro';
import SectionHeading from '@components/ui/SectionHeading.astro';
import BucketItem from '@components/common/BucketItem.astro';
import { supabase } from '@lib/supabase';

import { getEntry } from 'astro:content';

interface Props {
  lang: 'da' | 'en';
}

const { lang } = Astro.props;
const isDa = lang === 'da';

const entry = await getEntry('pages', `${lang}/bucketlist`);
if (!entry) {
  throw new Error(`Could not find content for ${lang}/bucketlist`);
}

const content = entry.data;

// Data Fetching
import { getBucketList } from '@lib/api';
const items = await getBucketList();

const todo = items.filter(i => i.status === 'todo');
const doing = items.filter(i => i.status === 'doing');
const done = items.filter(i => i.status === 'done');
---

<Layout 
  title={content.title} 
  description={content.desc}
>
  <main class="max-w-5xl mx-auto px-4 py-8">
     <Section>
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold mb-4 text-gold-400 drop-shadow-[0_0_15px_rgba(255,215,0,0.3)]">
                {content.heroTitle}
            </h1>
            <p class="text-dim text-lg">
                {content.heroText}
            </p>
        </div>

        <!-- DOING -->
        {doing.length > 0 && (
            <div class="mb-12">
                <SectionHeading>{content.doingTitle}</SectionHeading>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                    {doing.map((item: any) => <BucketItem item={item} />)}
                </div>
            </div>
        )}

        <!-- DONE -->
        {done.length > 0 && (
            <div class="mb-12">
                <SectionHeading>{content.doneTitle}</SectionHeading>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
                    {done.map((item: any) => <BucketItem item={item} />)}
                </div>
            </div>
        )}

        <!-- TODO -->
        <div class="mb-12">
            <SectionHeading>{content.todoTitle}</SectionHeading>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mt-6">
                {todo.map((item: any) => <BucketItem item={item} />)}
            </div>
        </div>

     </Section>
  </main>
</Layout>



