---
import Card from '../ui/Card.astro';
import Pill from '../ui/Pill.astro';


interface Props {
  title: string;
  tags?: string[];
  tagString?: string;
  description: string;
  tools?: string;
  output?: string;
  links?: {
    label: string;
    url: string;
    disabled?: boolean;
    icon?: string;
  }[];
  labUrl?: string;
  highlights?: { label: string; value: string }[];
  video?: string;
  blueprint?: string;
  lang?: 'da' | 'en' | 'de';
}

const { title, tagString, description, tools, output, links, lang = 'da', tags, labUrl, highlights, video, blueprint } = Astro.props;

const labels = {
  da: { tools: 'Værktøjer', output: 'Output' },
  en: { tools: 'Tools', output: 'Output' },
  de: { tools: 'Werkzeuge', output: 'Ergebnis' }
};

const t = labels[lang as keyof typeof labels] || labels.da;
---

<div class="project-card-wrapper h-full" data-tags={tags?.join(',') || ''}>
  <Card variant="bordered" class="flex flex-col h-full bg-[rgba(17,24,39,0.02)] group hover:bg-[rgba(17,24,39,0.05)] transition-colors">
    <div class="flex justify-between items-start mb-2 gap-2">
      <h2 class="text-[16px] font-bold leading-tight m-0 group-hover:text-accent transition-colors">{title}</h2>
      {tagString && <Pill variant="accent" class="shrink-0">{tagString}</Pill>}
    </div>
  
    <p class="text-[14px] text-dim flex-grow mb-4 leading-relaxed opacity-90">
      {description}
    </p>

    {/* The Impact: Dashboard Metrics */}
    {highlights && highlights.length > 0 && (
       <div class="grid grid-cols-2 gap-2 mb-4">
           {highlights.map(h => (
               <div class="bg-white/5 p-2 rounded border border-white/5">
                   <p class="text-[10px] uppercase text-dim tracking-wider font-bold mb-0.5">{h.label}</p>
                   <p class="text-sm font-bold text-accent">{h.value}</p>
               </div>
           ))}
       </div>
    )}

    {/* The Blueprint: Diagrams */}
    {blueprint && (
        <div class="mb-4 rounded-lg overflow-hidden border border-white/10 group-hover:border-accent/20 transition-colors">
            <div class="bg-black/40 p-1.5 flex items-center justify-between">
                <span class="text-[10px] text-dim font-mono"><i class="fa-solid fa-diagram-project mr-1.5"></i>Architecture</span>
                <span class="text-[10px] text-accent/50 group-hover:text-accent">• Live</span>
            </div>
            <img src={blueprint} alt="System Architecture" class="w-full h-auto opacity-80 group-hover:opacity-100 transition-opacity" />
        </div>
    )}
    
    <div class="flex flex-col gap-1 mb-4 text-[13px] text-dim">
      {tools && <span><strong class="text-text">{t.tools}:</strong> {tools}</span>}
      {output && <span><strong class="text-text">{t.output}:</strong> {output}</span>}
    </div>
  
    <div class="mt-auto pt-3 border-t border-[var(--glass-border)] flex flex-wrap gap-3 items-center">
      {labUrl && (
        <a 
          href={labUrl}
          target="_blank"
          rel="noopener noreferrer"
          class="text-xs font-bold text-accent bg-accent/10 hover:bg-accent hover:text-black px-2 py-1 rounded transition-colors inline-flex items-center gap-1.5 border border-accent/20"
        >
          <i class="fa-solid fa-flask"></i> Launch Lab
        </a>
      )}

      {links && links.map(link => (
          <a 
            href={link.url}
            class:list={[
              "text-xs font-bold transition-colors inline-flex items-center",
              link.disabled ? "opacity-50 cursor-not-allowed text-dim" : "text-dim hover:text-white"
            ]}
            aria-disabled={link.disabled}
          >
            {link.label} {link.icon === 'arrow-right' && '→'}
          </a>
        ))}
    </div>
  </Card>
</div>

