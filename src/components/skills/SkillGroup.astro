---
import Card from '@components/ui/Card.astro';
import Pill from '@components/ui/Pill.astro';

interface Skill {
    id?: string;
    icon?: string;
    name: string;
    title?: string;
    level?: string;
    verifiedIn?: { title: string; href: string; grade: string }[];
}

interface Props {
    title: string;
    skills: Skill[];
    variant?: 'default' | 'stack'; // 'default' = big cards, 'stack' = smaller pills/list
}

const { title, skills, variant = 'default' } = Astro.props;
---

<div class="skill-group">
    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
        {title}
    </h2>

    <div class:list={[
        "grid gap-4",
        variant === 'default' ? "grid-cols-1 md:grid-cols-2" : "grid-cols-2 md:grid-cols-3"
    ]}>
        {skills.map(skill => (
            <Card variant="glass" class:list={[
                "p-4 flex flex-col items-start gap-3 h-full group transition-all hover:bg-white/5",
                variant === 'default' ? "min-h-[140px]" : "min-h-[80px]"
            ]}>
                <div class="flex justify-between w-full items-start">
                    <div class="flex items-center gap-3">
                         {skill.icon && <i class={`${skill.icon} text-2xl text-accent`}></i>}
                         <h3 class:list={[
                             "font-bold leading-tight",
                             variant === 'default' ? "text-lg" : "text-sm"
                         ]}>{skill.name}</h3>
                    </div>
                </div>

                {variant === 'default' && (
                     <p class="text-sm text-dim">
                        {skill.title}
                     </p>
                )}

                {/* Verified Badge Logic */}
                {skill.verifiedIn && skill.verifiedIn.length > 0 && (
                    <div class="mt-auto pt-3 border-t border-white/5 w-full">
                        <p class="text-[10px] uppercase text-dim mb-1 font-bold tracking-wider">Verified in</p>
                        {skill.verifiedIn.slice(0, 1).map(c => (
                            <a href={c.href} class="flex items-center gap-2 text-xs hover:text-white transition-colors group/link">
                                <span class="truncate max-w-[150px]">{c.title}</span>
                                {c.grade && <Pill variant="accent" class="text-[10px] py-0 px-1.5 h-4">Grade: {c.grade}</Pill>}
                            </a>
                        ))}
                         {skill.verifiedIn.length > 1 && (
                            <span class="text-[10px] text-dim ml-1">+ {skill.verifiedIn.length - 1} more</span>
                        )}
                    </div>
                )}
            </Card>
        ))}
    </div>
</div>
